<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>–ñ—É—Ä–Ω–∞–ª –≤–∏—ó–∑–¥—ñ–≤</title>

<style>
body {
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
  background: #eef5f1;
  margin: 0;
  padding: 16px;
}

.card {
  max-width: 520px;
  margin: auto;
  background: #fff;
  border-radius: 16px;
  padding: 20px;
  box-shadow: 0 12px 30px rgba(0,0,0,.12);
}

h2 {
  margin-top: 0;
  color: #0f766e;
}

label {
  display: block;
  margin-top: 14px;
  font-weight: 600;
}

input, select {
  width: 100%;
  padding: 12px;
  font-size: 16px;
  border-radius: 12px;
  border: 1px solid #cbd5e1;
  box-sizing: border-box;
}

input:focus, select:focus {
  outline: none;
  border-color: #0f766e;
}

.autocomplete {
  position: relative;
}

.list {
  position: absolute;
  top: 100%;
  left: 0;
  right: 0;
  background: #fff;
  border-radius: 12px;
  margin-top: 4px;
  max-height: 220px;
  overflow-y: auto;
  box-shadow: 0 10px 25px rgba(0,0,0,.15);
  z-index: 100;
}

.list div {
  padding: 10px 14px;
  cursor: pointer;
}

.list div:hover {
  background: #ecfdf5;
}

button {
  margin-top: 22px;
  width: 100%;
  padding: 14px;
  font-size: 17px;
  border-radius: 14px;
  border: none;
  background: #0f766e;
  color: white;
}
</style>
</head>

<body>
<div class="card">

<h2>–ó–∞–ø–∏—Å –≤–∏—ó–∑–¥—É</h2>

<label>–¢–∏–ø –µ–∫—ñ–ø–∞–∂—É</label>
<select id="type">
  <option value="">–û–±–µ—Ä—ñ—Ç—å</option>
  <option>–ë–æ–π–æ–≤–∏–π</option>
  <option>–ù–µ –±–æ–π–æ–≤–∏–π</option>
</select>

<label>–ó–≤—ñ–¥–∫–∏</label>
<div class="autocomplete">
  <input id="from">
  <div class="list" id="fromList"></div>
</div>

<label>–ö—É–¥–∏</label>
<div class="autocomplete">
  <input id="to">
  <div class="list" id="toList"></div>
</div>

<label id="purposeLabel" style="display:none;">–ú–µ—Ç–∞</label>
<div class="autocomplete">
  <input id="purpose" style="display:none;">
  <div class="list" id="purposeList"></div>
</div>

<h3>–°–∫–ª–∞–¥ –µ–∫—ñ–ø–∞–∂—É</h3>

<div class="autocomplete"><input id="p1" placeholder="1 –ª—é–¥–∏–Ω–∞"><div class="list"></div></div>
<div class="autocomplete"><input id="p2" placeholder="2 –ª—é–¥–∏–Ω–∞"><div class="list"></div></div>
<div class="autocomplete"><input id="p3" placeholder="3 –ª—é–¥–∏–Ω–∞"><div class="list"></div></div>
<div class="autocomplete"><input id="p4" placeholder="4 –ª—é–¥–∏–Ω–∞"><div class="list"></div></div>
<div class="autocomplete"><input id="p5" placeholder="5 –ª—é–¥–∏–Ω–∞"><div class="list"></div></div>
<div class="autocomplete"><input id="p6" placeholder="6 –ª—é–¥–∏–Ω–∞"><div class="list"></div></div>

<div class="autocomplete"><input id="s1" placeholder="1 —Å—É–ø—Ä–æ–≤—ñ–¥"><div class="list"></div></div>
<div class="autocomplete"><input id="s2" placeholder="2 —Å—É–ø—Ä–æ–≤—ñ–¥"><div class="list"></div></div>

<div class="autocomplete"><input id="driver" placeholder="–í–æ–¥—ñ–π"><div class="list"></div></div>

<button onclick="send()">–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏</button>

</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxmsbybL9Ka-6VRJZIuWLuh4YV7ojdSBywxvMTq9zI4gdW_VA3Hhwj4O3ACzvT3c50S/exec";

function bindAutocomplete(input, list, source){
  input.addEventListener("input", () => {
    const v = input.value.trim().toLowerCase();
    list.innerHTML = "";
    if (!v) return;

    source
      .filter(x => x.toLowerCase().includes(v))
      .slice(0, 20)
      .forEach(x => {
        const div = document.createElement("div");
        div.textContent = x;
        div.onclick = () => {
          input.value = x;
          list.innerHTML = "";
        };
        list.appendChild(div);
      });
  });

  // –∑–∞–∫—Ä–∏—Ç—Ç—è —Å–ø–∏—Å–∫—É –ø—Ä–∏ –∫–ª—ñ–∫—É –ø–æ–∑–∞ –ø–æ–ª–µ–º
  document.addEventListener("click", e => {
    if (!input.contains(e.target) && !list.contains(e.target)) {
      list.innerHTML = "";
    }
  });
}

// üîπ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö
fetch(SCRIPT_URL)
  .then(r => r.json())
  .then(DATA => {

    // üîπ –õ–æ–∫–∞—Ü—ñ—ó
    bindAutocomplete(from, fromList, DATA.locations);
    bindAutocomplete(to, toList, DATA.locations);

    // üîπ –ú–µ—Ç–∞
    bindAutocomplete(purpose, purposeList, DATA.purposes);

    // üîπ –õ—é–¥–∏
    document.querySelectorAll(".autocomplete").forEach(box => {
      const input = box.querySelector("input");
      const list  = box.querySelector(".list");
      if (input && list && !["from","to","purpose"].includes(input.id)) {
        bindAutocomplete(input, list, DATA.people);
      }
    });

  });

// üîπ –¢–∏–ø –µ–∫—ñ–ø–∞–∂—É
type.onchange = () => {
  const show = type.value === "–ù–µ –±–æ–π–æ–≤–∏–π";
  purpose.style.display = show ? "block" : "none";
  purposeLabel.style.display = show ? "block" : "none";
  if (!show) purpose.value = "";
};

// üîπ –í—ñ–¥–ø—Ä–∞–≤–∫–∞
function send(){
  const params = new URLSearchParams({
    type:type.value, from:from.value, to:to.value,
    purpose:purpose.value,
    p1:p1.value,p2:p2.value,p3:p3.value,
    p4:p4.value,p5:p5.value,p6:p6.value,
    s1:s1.value,s2:s2.value,driver:driver.value
  });

  fetch(SCRIPT_URL + "?" + params)
    .then(() => alert("–ó–∞–ø–∏—Å –¥–æ–¥–∞–Ω–æ"));
}
</script>
</body>
</html>
