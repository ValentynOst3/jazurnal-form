<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Запис виїзду</title>

<style>
:root {
  --green: #0f766e;
  --green-light: #d1fae5;
  --border: #d1d5db;
}

* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: system-ui, -apple-system, Segoe UI, sans-serif;
  background: #f0fdf4;
}

.container {
  max-width: 520px;
  margin: auto;
  padding: 16px;
}

.card {
  background: #fff;
  border-radius: 16px;
  padding: 20px;
  box-shadow: 0 10px 30px rgba(0,0,0,.08);
}

h1 {
  margin-top: 0;
  color: var(--green);
}

.field {
  margin-top: 16px;
}

label {
  display: block;
  font-weight: 600;
  margin-bottom: 6px;
}

.input {
  width: 100%;
  padding: 14px;
  border-radius: 12px;
  border: 1px solid var(--border);
  font-size: 16px;
}

.input:focus {
  outline: none;
  border-color: var(--green);
  background: var(--green-light);
}

button {
  width: 100%;
  margin-top: 24px;
  padding: 14px;
  border-radius: 14px;
  border: none;
  background: var(--green);
  color: white;
  font-size: 16px;
  font-weight: 600;
}

button:active {
  transform: scale(.98);
}

/* AUTOCOMPLETE (desktop) */
.dropdown {
  position: absolute;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 10px 20px rgba(0,0,0,.12);
  max-height: 220px;
  overflow-y: auto;
  width: 100%;
  z-index: 10;
}

.dropdown div {
  padding: 12px;
  cursor: pointer;
}

.dropdown div:hover {
  background: var(--green-light);
}

/* BOTTOM SHEET */
.sheet {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.4);
  display: none;
}

.sheet.active { display: block; }

.sheet-box {
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  background: #fff;
  border-radius: 20px 20px 0 0;
  padding: 16px;
  max-height: 80vh;
  overflow: auto;
}
</style>
</head>

<body>

<div class="container">
  <div class="card">
    <h1>Запис виїзду</h1>

    <div class="field">
      <label>Тип екіпажу</label>
      <select id="type" class="input">
        <option value="">Оберіть</option>
        <option>Бойовий</option>
        <option>Не бойовий</option>
      </select>
    </div>

    <div class="field">
      <label>Звідки</label>
      <input class="input" id="from" readonly>
    </div>

    <div class="field">
      <label>Куди</label>
      <input class="input" id="to" readonly>
    </div>

    <div class="field" id="purposeField" style="display:none">
      <label>Мета</label>
      <input class="input" id="purpose" readonly>
    </div>

    <h3>Склад екіпажу</h3>
    <div id="crew"></div>

    <button onclick="send()">Відправити</button>
  </div>
</div>

<div class="sheet" id="sheet">
  <div class="sheet-box">
    <input class="input" id="sheetInput" placeholder="Введіть...">
    <div id="sheetList"></div>
  </div>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxmsbybL9Ka-6VRJZIuWLuh4YV7ojdSBywxvMTq9zI4gdW_VA3Hhwj4O3ACzvT3c50S/exec";

let DATA = {};
let activeInput = null;

fetch(SCRIPT_URL).then(r=>r.json()).then(d=>DATA=d);

const crewBox = document.getElementById("crew");
["1 людина","2 людина","3 людина","4 людина","5 людина","6 людина","1 супровід","2 супровід","Водій"]
.forEach(t=>{
  const i=document.createElement("input");
  i.className="input";
  i.placeholder=t;
  i.readOnly=true;
  crewBox.appendChild(i);
  bindAutocomplete(i,"people");
});

bindAutocomplete(from,"locations");
bindAutocomplete(to,"locations");
bindAutocomplete(purpose,"purposes");

type.onchange=()=>purposeField.style.display=
  type.value==="Не бойовий"?"block":"none";

function bindAutocomplete(input,key){
  input.onclick=()=>{
    activeInput=input;
    openSheet(DATA[key]||[]);
  }
}

function openSheet(list){
  sheet.classList.add("active");
  sheetInput.value="";
  renderList(list);
  sheetInput.oninput=()=>{
    const q=sheetInput.value.toLowerCase();
    renderList(list.filter(v=>v.toLowerCase().includes(q)));
  };
}

function renderList(arr){
  sheetList.innerHTML="";
  arr.forEach(v=>{
    const d=document.createElement("div");
    d.textContent=v;
    d.onclick=()=>{
      activeInput.value=v;
      sheet.classList.remove("active");
    };
    sheetList.appendChild(d);
  });
}

sheet.onclick=e=>{
  if(e.target===sheet) sheet.classList.remove("active");
}

function send(){
  alert("Запис додано");
}
</script>

</body>
</html>
